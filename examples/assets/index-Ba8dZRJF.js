import{k as x,H as j,Q as le,z as M,b as V,q as K,y as ue,o as S,p as Q,x as de,s as X,t as Z,u as ee,v as fe,I as te,w as ne,R as me,A as pe,D as ge,E as he,J as be,l as ye,K as Ce,a as oe,P as z,S as _,h as A,W as Ie,X as we,Y as Ne,j as H,O as xe,Z as Ee,$ as Re}from"./template-DD9ofnYC.js";const Ae={"jhon.doe@example.com":{name:"Jhon Doe",picture:"https://www.profilebakery.com/wp-content/uploads/2023/04/Profile-Image-AI.jpg"}},Te=(t,n)=>{const s=(n??Ae)[t],l=(s==null?void 0:s.name)??t,r=l.trim().split(/\s+/);let a,c;return r[0]&&r[0][0]&&(a=r[0][0].toUpperCase(),r[0][1]&&(c=r[0][1].toUpperCase())),r[1]&&r[1][0]&&(c=r[1][0].toUpperCase()),x`
  <div style="display: flex; gap: 0.25rem; overflow: hidden;">
    ${!(s!=null&&s.picture)&&(a||c)?x`
      <bim-label
        style=${le({borderRadius:"999px",padding:"0.375rem",backgroundColor:"var(--bim-ui_bg-contrast-20)",aspectRatio:"1",fontSize:"0.7rem"})}>${a}${c}</bim-label>
      `:null}
    <bim-label .img=${s==null?void 0:s.picture}>${l}</bim-label>
  </div>
`},Se=t=>{const{topic:n,styles:i,viewpoint:s,actions:l}=t,r={delete:!0,...l};return x`<bim-table @cellcreated=${({detail:c})=>{const{cell:o}=c;o.style.marginLeft="0"}} ${j(c=>{if(!c)return;const o=c;o.headersHidden=!0,o.hiddenColumns=["guid","author"],o.dataTransform={Comment:(g,m)=>{const{guid:f}=m;if(typeof f!="string")return g;const e=n.comments.get(f);if(!e)return g;const u=()=>{n.comments.delete(f)};return x`
        <div style="display: flex; flex-direction: column; gap: 0.25rem; flex: 1">
          <div style="display: flex; justify-content: space-between;">
            <div style="display: flex; gap: 0.375rem;">
              ${Te(e.author,i)}
              <bim-label style="color: var(--bim-ui_bg-contrast-40)">@ ${e.date.toDateString()}</bim-label>
            </div>
            <div>
              <style>
                #TCDBT {
                  background-color: transparent;
                  --bim-label--c: var(--bim-ui_bg-contrast-60)
                }

                #TCDBT:hover {
                  --bim-label--c: #FF5252;
                }
              </style>
              ${r!=null&&r.delete?x`<bim-button @click=${u} id="TCDBT" icon="majesticons:delete-bin"></bim-button>`:null}
            </div>
          </div>
          <bim-label style="margin-left: 1.7rem; white-space: normal">${e.comment}</bim-label>
        </div>
      `}};let d=n.comments.values();s&&(d=[...n.comments.values()].filter(g=>g.viewpoint===s)),o.data=[...d].map(g=>({data:{guid:g.guid,Comment:g.comment,author:(()=>{const m=i;if(!m)return g.author;const f=m[g.author];return(f==null?void 0:f.name)??g.author})()}}))})}><bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">This topic has no comments</bim-label></bim-table>`},De=(t,n=!0)=>{const i=M.create(Se,t);if(n){const{topic:s}=t,[l,r]=i;s.comments.onItemSet.add(()=>r()),s.comments.onItemUpdated.add(()=>r()),s.comments.onItemDeleted.add(()=>r()),s.comments.onCleared.add(()=>r())}return i},Oe=Object.freeze(Object.defineProperty({__proto__:null,topicComments:De},Symbol.toStringTag,{value:"Module"})),$e=t=>{const{components:n,actions:i,tags:s}=t,l=(i==null?void 0:i.dispose)??!0,r=(i==null?void 0:i.download)??!0,a=(i==null?void 0:i.visibility)??!0,c=(s==null?void 0:s.schema)??!0,o=(s==null?void 0:s.viewDefinition)??!0,d=n.get(V),g=({detail:f})=>{const{cell:e}=f;e.style.padding="0.25rem 0"};return x`
    <bim-table ${j(f=>{if(!f)return;const e=f;e.hiddenColumns=["modelID"];const u=[];for(const[,b]of d.groups){if(!b)continue;const w={data:{Name:b.name||b.uuid,modelID:b.uuid}};u.push(w)}e.dataTransform={Name:(b,w)=>{const{modelID:I}=w;if(typeof I!="string")return b;const N=d.groups.get(I);if(!N)return I;const p={};for(const D of N.items)p[D.id]=D.ids;let h;const{schema:y}=N.ifcMetadata;c&&y&&(h=x`
            <bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${y}</bim-label>
            `);let C;if(o&&"viewDefinition"in N.ifcMetadata){const D=N.ifcMetadata.viewDefinition;C=x`
            ${D.split(",").map(T=>x`<bim-label style="background-color: var(--bim-ui_main-base); padding: 0 0.25rem; color: var(--bim-ui_main-contrast); border-radius: 0.25rem;">${T}</bim-label>`)}
          `}let R;l&&(R=x`<bim-button @click=${()=>d.disposeGroup(N)} icon="mdi:delete"></bim-button>`);let $;a&&($=x`<bim-button @click=${T=>{const P=n.get(K),G=T.target;P.set(G.hasAttribute("data-model-hidden"),p),G.toggleAttribute("data-model-hidden"),G.icon=G.hasAttribute("data-model-hidden")?"mdi:eye-off":"mdi:eye"}} icon="mdi:eye"></bim-button>`);let v;return r&&(v=x`<bim-button @click=${()=>{const T=document.createElement("input");T.type="file",T.accept=".ifc",T.multiple=!1,T.addEventListener("change",async()=>{if(!(T.files&&T.files.length===1))return;const P=T.files[0],G=await P.arrayBuffer(),ce=await n.get(ue).saveToIfc(N,new Uint8Array(G)),Y=new File([ce],P.name),U=document.createElement("a");U.href=URL.createObjectURL(Y),U.download=Y.name,U.click(),URL.revokeObjectURL(U.href)}),T.click()}} icon="flowbite:download-solid"></bim-button>`),x`
         <div style="display: flex; flex: 1; gap: var(--bim-ui_size-4xs); justify-content: space-between; overflow: auto;">
          <div style="display: flex; flex-wrap: wrap; align-items: center; gap: 0 var(--bim-ui_size-4xs); flex-grow: 1; overflow: auto;">
            <div style="min-height: 1.75rem; overflow: auto; display: flex;">
              <bim-label style="white-space: normal;">${b}</bim-label>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: var(--bim-ui_size-4xs); overflow: auto;">
              ${h}
              ${C}
            </div>
          </div>
          <div style="display: flex; align-self: flex-start; flex-shrink: 0;">
            ${v}
            ${$}
            ${R}
          </div>
         </div>
        `}},e.data=u})} @cellcreated=${g} headers-hidden no-indentation>
      <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No models has been loaded yet
      </bim-label>
    </bim-table>
  `},ve=(t,n=!0)=>{const i=M.create($e,t);if(n){const{components:s}=t,l=s.get(V),[,r]=i;l.onFragmentsLoaded.add(()=>setTimeout(()=>r())),l.onFragmentsDisposed.add(()=>r())}return i},Le=Object.freeze(Object.defineProperty({__proto__:null,modelsList:ve},Symbol.toStringTag,{value:"Module"})),ie=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification",t=>t.includes("Value"),t=>t.startsWith("Material"),t=>t.startsWith("Relating"),t=>{const n=["IsGroupedBy","IsDecomposedBy"];return t.startsWith("Is")&&!n.includes(t)}];async function J(t,n,i,s=ie,l=!1){const r=t.get(S),a=await n.getProperties(i);if(!a)return{data:{Entity:`${i} properties not found...`}};const c=r.relationMaps[n.uuid],o={data:{}};for(const d in a){const g=s.map(f=>typeof f=="string"?d===f:f(d)).includes(!0);if(!(d==="type"||g))continue;const m=a[d];if(m)if(m.type===5){o.children||(o.children=[]);const f=await J(t,n,m.value,s,l);o.children.push(f)}else if(typeof m=="object"&&!Array.isArray(m)){const{value:f,type:e}=m;if(l)e===1||e===2||e===3||(o.data[d]=f);else{const u=typeof f=="number"?Number(f.toFixed(3)):f;o.data[d]=u}}else if(Array.isArray(m))for(const f of m){if(f.type!==5)continue;o.children||(o.children=[]);const e=await J(t,n,f.value,s,l);o.children.push(e)}else if(d==="type"){const f=Q[m];o.data.Entity=f}else o.data[d]=m}if(c&&c.get(a.expressID)){const d=c.get(a.expressID);for(const g of s){const m=[];if(typeof g=="string"){const f=r._inverseAttributes.indexOf(g);f!==-1&&m.push(f)}else{const f=r._inverseAttributes.filter(e=>g(e));for(const e of f){const u=r._inverseAttributes.indexOf(e);m.push(u)}}for(const f of m){const e=d.get(f);if(e)for(const u of e){const b=await J(t,n,u,s,l);o.children||(o.children=[]),o.children.push(b)}}}}return o}const ke=t=>{const{components:n,fragmentIdMap:i,attributesToInclude:s,editable:l,tableDefinition:r}=t,a=n.get(V);let c;return typeof s=="function"?c=s(ie):c=s,x`<bim-table ${j(async d=>{if(!d)return;const g=d,m=[],f=[];for(const e in i){const u=a.list.get(e);if(!(u&&u.group))continue;const b=u.group,w=f.find(I=>I.model===b);if(w)for(const I of i[e])w.expressIDs.add(I);else{const I={model:b,expressIDs:new Set(i[e])};f.push(I)}}for(const e of f){const{model:u,expressIDs:b}=e;for(const w of b){const I=await J(n,u,w,c,l);m.push(I)}}g.dataTransform=r,g.data=m,g.columns=[{name:"Entity",width:"minmax(15rem, 1fr)"}]})}></bim-table>`},Me=t=>M.create(ke,t),Ve=Object.freeze(Object.defineProperty({__proto__:null,entityAttributes:Me},Symbol.toStringTag,{value:"Module"}));let L;const Pe=t=>{const{components:n,classifications:i}=t,s=n.get(de),l=n.get(K);L||(L=document.createElement("bim-table"),L.headersHidden=!0,L.hiddenColumns=["system"],L.columns=["Name",{name:"Actions",width:"auto"}],L.dataTransform={Actions:(a,c)=>{const{system:o,Name:d}=c;if(!(typeof o=="string"&&typeof d=="string"))return a;const g=s.list[o];if(!(g&&g[d]))return a;const m=g[d],{map:f}=m;return x`
          <div>
            <bim-checkbox checked @change=${u=>{const b=u.target;l.set(b.value,f)}}></bim-checkbox>
          </div>
        `}});const r=[];for(const a of i){const c=typeof a=="string"?a:a.system,o=typeof a=="string"?a:a.label,d=s.list[c];d&&r.push({data:{Name:o,system:c},children:Object.keys(d).map(g=>({data:{Name:g,system:c,Actions:""}}))})}return L.data=r,x`${L}`},Ge=(t,n=!0)=>{const i=M.create(Pe,t);if(n){const{components:s}=t,l=s.get(V),[,r]=i;l.onFragmentsDisposed.add(()=>r())}return i},Fe=Object.freeze(Object.defineProperty({__proto__:null,classificationTree:Ge},Symbol.toStringTag,{value:"Module"})),se=async(t,n,i)=>{var c,o,d,g;const s=t.get(S),l={data:{Name:(c=i.Name)==null?void 0:c.value},children:[{data:{Name:"Identification",Value:(o=i.Identification)==null?void 0:o.value}},{data:{Name:"Name",Value:(d=i.Name)==null?void 0:d.value}},{data:{Name:"Description",Value:(g=i.Description)==null?void 0:g.value}}]},r=s.getEntityRelations(n,i.expressID,"IsNestedBy");if(!r)return l;l.children||(l.children=[]);const a=[];l.children.push({data:{Name:"Tasks"},children:a});for(const m of r){const f=await n.getProperties(m);if(!f)continue;const e=await se(t,n,f);a.push(e)}return l},_e=async(t,n,i)=>{const s=[];for(const r of i){const a=await se(t,n,r);s.push(a)}return{data:{Name:"Tasks"},children:s}},We=async(t,n)=>{var s,l,r,a;const i={data:{Name:"Classifications"}};for(const c of n){const{value:o}=c.ReferencedSource,d=await t.getProperties(o);if(!d)continue;const g={data:{Name:(s=d.Name)==null?void 0:s.value},children:[{data:{Name:"Identification",Value:((l=c.Identification)==null?void 0:l.value)||((r=c.ItemReference)==null?void 0:r.value)}},{data:{Name:"Name",Value:(a=c.Name)==null?void 0:a.value}}]};i.children||(i.children=[]),i.children.push(g)}return i},je=async(t,n)=>{var s,l,r,a,c,o;const i={data:{Name:"Materials"}};for(const d of n){if(d.type===X){const g=(s=d.ForLayerSet)==null?void 0:s.value,m=await t.getProperties(g);if(!m)continue;for(const f of m.MaterialLayers){const{value:e}=f,u=await t.getProperties(e);if(!u)continue;const b=await t.getProperties((l=u.Material)==null?void 0:l.value);if(!b)continue;const w={data:{Name:"Layer"},children:[{data:{Name:"Thickness",Value:(r=u.LayerThickness)==null?void 0:r.value}},{data:{Name:"Material",Value:(a=b.Name)==null?void 0:a.value}}]};i.children||(i.children=[]),i.children.push(w)}}if(d.type===Z)for(const g of d.Materials){const{value:m}=g,f=await t.getProperties(m);if(!f)continue;const e={data:{Name:"Name",Value:(c=f.Name)==null?void 0:c.value}};i.children||(i.children=[]),i.children.push(e)}if(d.type===ee){const g={data:{Name:"Name",Value:(o=d.Name)==null?void 0:o.value}};i.children||(i.children=[]),i.children.push(g)}}return i},He={IFCLENGTHMEASURE:"LENGTHUNIT",IFCAREAMEASURE:"AREAUNIT",IFCVOLUMEMEASURE:"VOLUMEUNIT",IFCPLANEANGLEMEASURE:"PLANEANGLEUNIT"},Ue={MILLIMETRE:{symbol:"mm",digits:0},METRE:{symbol:"m",digits:2},KILOMETRE:{symbol:"km",digits:2},SQUARE_METRE:{symbol:"m²",digits:2},CUBIC_METRE:{symbol:"m³",digits:2},DEGREE:{symbol:"°",digits:2},RADIAN:{symbol:"rad",digits:2},GRAM:{symbol:"g",digits:0},KILOGRAM:{symbol:"kg",digits:2},MILLISECOND:{symbol:"ms",digits:0},SECOND:{symbol:"s",digits:0}},re=async(t,n)=>{var l,r,a;const i=Object.values(await t.getAllPropertiesOfType(fe))[0];let s;for(const c of i.Units){const o=await t.getProperties(c.value);if(o&&((l=o.UnitType)==null?void 0:l.value)===He[n]){s=`${((r=o.Prefix)==null?void 0:r.value)??""}${((a=o.Name)==null?void 0:a.value)??""}`;break}}return s?Ue[s]:null},ze=async(t,n,i)=>{var r,a;const{displayUnits:s}=i,l={data:{Name:"PropertySets"}};for(const c of n){const o={data:{Name:(r=c.Name)==null?void 0:r.value}};if(c.type===te){for(const d of c.HasProperties){const{value:g}=d,m=await t.getProperties(g);if(!m)continue;const f=Object.keys(m).find(w=>w.includes("Value"));if(!(f&&m[f]))continue;let e=m[f].value,u="";if(s){const{name:w}=m[f],I=await re(t,w)??{};u=I.symbol,e=m[f].value,typeof e=="number"&&I.digits&&(e=e.toFixed(I.digits))}const b={data:{Name:(a=m.Name)==null?void 0:a.value,Value:`${e} ${u??""}`}};o.children||(o.children=[]),o.children.push(b)}o.children&&(l.children||(l.children=[]),l.children.push(o))}}return l},Be=async(t,n,i)=>{var r,a;const{displayUnits:s}=i,l={data:{Name:"QuantitySets"}};for(const c of n){const o={data:{Name:(r=c.Name)==null?void 0:r.value}};if(c.type===ne){for(const d of c.Quantities){const{value:g}=d,m=await t.getProperties(g);if(!m)continue;const f=Object.keys(m).find(w=>w.includes("Value"));if(!(f&&m[f]))continue;let e=m[f].value,u="";if(s){const{name:w}=m[f],I=await re(t,w)??{};u=I.symbol,e=m[f].value,typeof e=="number"&&I.digits&&(e=e.toFixed(I.digits))}const b={data:{Name:(a=m.Name)==null?void 0:a.value,Value:`${e} ${u??""}`}};o.children||(o.children=[]),o.children.push(b)}o.children&&(l.children||(l.children=[]),l.children.push(o))}}return l},Je=["OwnerHistory","ObjectPlacement","CompositionType"],ae=async(t,n)=>{const s={...{groupName:"Attributes",includeClass:!1},...n},{groupName:l,includeClass:r}=s,a={data:{Name:l}};r&&(a.children||(a.children=[]),a.children.push({data:{Name:"Class",Value:Q[t.type]}}));for(const c in t){if(Je.includes(c))continue;const o=t[c];if(o&&typeof o=="object"&&!Array.isArray(o)){if(o.type===me)continue;const d={data:{Name:c,Value:o.value}};a.children||(a.children=[]),a.children.push(d)}}return a},F=(t,...n)=>{t.children||(t.children=[]),t.children.push(...n)},Qe=async(t,n,i,s,l)=>{const a=t.get(S).getEntityRelations(n,i,"IsDefinedBy");if(a){const c=[],o=[];for(const m of a){const f=await n.getProperties(m);f&&(f.type===te&&c.push(f),f.type===ne&&o.push(f))}const d=await ze(n,c,l);d.children&&F(s,d);const g=await Be(n,o,l);g.children&&F(s,g)}},qe=async(t,n,i,s)=>{const r=t.get(S).getEntityRelations(n,i,"HasAssociations");if(r){const a=[],c=[];for(const g of r){const m=await n.getProperties(g);m&&(m.type===pe&&a.push(m),(m.type===X||m.type===ge||m.type===he||m.type===ee||m.type===Z)&&c.push(m))}const o=await We(n,a);o.children&&F(s,o);const d=await je(n,c);d.children&&F(s,d)}},Ye=async(t,n,i,s)=>{const r=t.get(S).getEntityRelations(n,i,"HasAssignments");if(r){const a=[];for(const o of r){const d=await n.getProperties(o);d&&d.type===be&&a.push(d)}const c=await _e(t,n,a);c.children&&F(s,c)}},Ke=async(t,n,i,s)=>{const r=t.get(S).getEntityRelations(n,i,"ContainedInStructure");if(r&&r[0]){const a=r[0],c=await n.getProperties(a);if(c){const o=await ae(c,{groupName:"SpatialContainer"});F(s,o)}}};let B={};const Xe=async(t,n,i)=>{var c;const s=t.get(S),l=t.get(V),r=l.getModelIdMap(n);Object.keys(n).length===0&&(B={});const a=[];for(const o in r){const d=l.groups.get(o);if(!d)continue;const g=s.relationMaps[d.uuid];if(!g)continue;o in B||(B[o]=new Map);const m=B[o],f=r[o];for(const e of f){let u=m.get(e);if(u){a.push(u);continue}const b=await d.getProperties(e);if(!b)continue;u={data:{Name:(c=b.Name)==null?void 0:c.value}},a.push(u),m.set(e,u);const w=await ae(b,{includeClass:!0});u.children||(u.children=[]),u.children.push(w),g.get(e)&&(await Qe(t,d,e,u,i),await qe(t,d,e,u),await Ye(t,d,e,u),await Ke(t,d,e,u))}}return a},Ze=t=>{const n={emptySelectionWarning:!0,...t},{components:i,fragmentIdMap:s,emptySelectionWarning:l}=n;return x`
    <bim-table @cellcreated=${({detail:c})=>{const{cell:o}=c;o.column==="Name"&&!("Value"in o.rowData)&&(o.style.gridColumn="1 / -1")}} ${j(async c=>{if(!c)return;const o=c;o.columns=[{name:"Name",width:"12rem"}],o.headersHidden=!0,o.loadFunction=()=>Xe(i,s,t),await o.loadData(!0)&&o.dispatchEvent(new Event("datacomputed"))})}>
      ${l?x`
            <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
              Select some elements to display its properties
            </bim-label>
            `:null}
      <bim-label slot="error-loading" style="--bim-icon--c: #e72e2e" icon="bxs:error-alt">
        Something went wrong with the properties
      </bim-label>
    </bim-table>
  `},et=t=>M.create(Ze,t),tt=Object.freeze(Object.defineProperty({__proto__:null,elementProperties:et},Symbol.toStringTag,{value:"Module"})),q=async(t,n,i,s)=>{var d;const l=[],r=t.get(S),a=await n.getProperties(i);if(!a)return l;const{type:c}=a,o={data:{Entity:Q[c],Name:(d=a.Name)==null?void 0:d.value,modelID:n.uuid,expressID:i}};for(const g of s){const m=r.getEntityRelations(n,i,g);if(!m)continue;o.children||(o.children=[]),o.data.relations=JSON.stringify(m);const f={};for(const e of m){const u=await q(t,n,e,s);for(const b of u)if(b.data.relations)o.children.push(b);else{const w=n.data.get(e);if(!w){o.children.push(b);continue}const I=w[1][1],N=Q[I];N in f||(f[N]=[]),b.data.Entity=b.data.Name,delete b.data.Name,f[N].push(b)}}for(const e in f){const u=f[e],b=u.map(I=>I.data.expressID),w={data:{Entity:e,modelID:n.uuid,relations:JSON.stringify(b)},children:u};o.children.push(w)}}return l.push(o),l},nt=async(t,n,i,s)=>{const l=t.get(S),r=[];for(const a of n){let c;if(s)c={data:{Entity:a.name!==""?a.name:a.uuid},children:await q(t,a,s,i)};else{const o=l.relationMaps[a.uuid],d=await a.getAllPropertiesOfType(Ce);if(!(o&&d))continue;const{expressID:g}=Object.values(d)[0];c={data:{Entity:a.name!==""?a.name:a.uuid},children:await q(t,a,g,i)}}r.push(c)}return r};let O;const ot=(t,n)=>{const i=t.get(V),{modelID:s,expressID:l,relations:r}=n.data;if(!s)return null;const a=i.groups.get(s);return a?a.getFragmentMap([l,...JSON.parse(r??"[]")]):null},it=t=>{const{components:n,models:i,expressID:s}=t,l=t.selectHighlighterName??"select",r=t.hoverHighlighterName??"hover";O||(O=document.createElement("bim-table"),O.hiddenColumns=["modelID","expressID","relations"],O.columns=["Entity","Name"],O.headersHidden=!0,O.addEventListener("cellcreated",({detail:c})=>{const{cell:o}=c;o.column==="Entity"&&!("Name"in o.rowData)&&(o.style.gridColumn="1 / -1")})),O.addEventListener("rowcreated",c=>{c.stopImmediatePropagation();const{row:o}=c.detail,d=n.get(ye),g=ot(n,o);g&&Object.keys(g).length!==0&&(o.onmouseover=()=>{r&&(o.style.backgroundColor="var(--bim-ui_bg-contrast-20)",d.highlightByID(r,g,!0,!1,d.selection[l]??{}))},o.onmouseout=()=>{o.style.backgroundColor="",d.clear(r)},o.onclick=()=>{l&&d.highlightByID(l,g,!0,!0)})});const a=t.inverseAttributes??["IsDecomposedBy","ContainsElements"];return nt(n,i,a,s).then(c=>O.data=c),x`${O}`},st=(t,n=!0)=>{const i=M.create(it,t);if(n){const[,s]=i,{components:l}=t,r=l.get(V),a=l.get(S),c=()=>s({models:r.groups.values()});a.onRelationsIndexed.add(c),r.onFragmentsDisposed.add(c)}return i},rt=Object.freeze(Object.defineProperty({__proto__:null,relationsTree:st},Symbol.toStringTag,{value:"Module"})),W=(t,n)=>[...t.get(xe).list.values()].find(l=>l.world===n),at=(t,n)=>x`
    <bim-color-input @input=${s=>{const l=s.target;t.color=new H(l.color)}} color=${n}></bim-color-input>
  `,ct=(t,n)=>{const{postproduction:i}=t,s=i.n8ao.configuration;return x`
    <bim-color-input @input=${r=>{const a=r.target;s.color=new H(a.color)}} color=${n}></bim-color-input>
  `},lt=(t,n)=>{const{color:i,opacity:s}=JSON.parse(n),{postproduction:l}=t,{customEffects:r}=l;return x`
    <bim-color-input @input=${c=>{const{color:o,opacity:d}=c.target;r.lineColor=new H(o).getHex(),d&&(r.opacity=d/100)}} color=${i} opacity=${s*100}></bim-color-input>
  `},ut=(t,n)=>x`
    <bim-color-input @input=${s=>{const l=s.target,r=new H(l.color);t.material.uniforms.uColor.value=r}} color=${n}></bim-color-input>
  `,dt=(t,n)=>{const{postproduction:i}=t;return x`
    <bim-checkbox @change=${l=>{const r=l.target;i.setPasses({ao:r.checked})}} .checked=${n}></bim-checkbox>
  `},ft=(t,n)=>{const{postproduction:i}=t;return x`
    <bim-checkbox @change=${l=>{const r=l.target;i.setPasses({gamma:r.checked})}} .checked=${n}></bim-checkbox>
  `},mt=(t,n)=>{const{postproduction:i}=t;return x`
    <bim-checkbox @change=${l=>{const r=l.target;i.setPasses({custom:r.checked})}} .checked=${n}></bim-checkbox>
  `},k=(t,n,i,s=()=>{})=>x`
    <bim-checkbox .checked="${i}" @change="${r=>{const c=r.target.checked;t[n]=c,s(c)}}"></bim-checkbox> 
  `,E=(t,n,i,s)=>{const l={slider:!1,min:0,max:100,step:1,prefix:null,suffix:null,onInputSet:()=>{},...s},{slider:r,min:a,max:c,step:o,suffix:d,prefix:g,onInputSet:m}=l;return x`
    <bim-number-input
      .pref=${g}
      .suffix=${d}
      .slider=${r} 
      min=${a} 
      value="${i}" 
      max=${c} 
      step=${o} 
      @change="${e=>{const b=e.target.value;t[n]=b,m(b)}}"
    ></bim-number-input> 
  `},pt=t=>{const{components:n}=t,i=n.get(oe);return x`
    <bim-table @cellcreated=${({detail:r})=>{const a=r.cell.parentNode;if(!a)return;const c=a.querySelector("bim-table-cell[column='Name']"),o=a.querySelector("bim-table-cell[column='Value']");c&&!o&&(c.style.gridColumn="1 / -1")}} ${j(async r=>{var o,d,g,m,f;if(!r)return;const a=r;a.preserveStructureOnFilter=!0,a.dataTransform={Value:(e,u)=>{const b=u.World,w=i.list.get(b);if(!w)return e;const{scene:I,camera:N,renderer:p}=w,h=u.Name;if(h==="Grid"&&u.IsGridConfig&&typeof e=="boolean"){const y=W(n,w);return y?k(y,"visible",e):e}if(h==="Color"&&u.IsGridConfig&&typeof e=="string"){const y=W(n,w);return y?ut(y,e):e}if(h==="Distance"&&u.IsGridConfig&&typeof e=="number"){const y=W(n,w);return y?E(y.material.uniforms.uDistance,"value",e,{slider:!0,min:300,max:1e3}):e}if(h==="Size"&&u.IsGridConfig&&typeof e=="string"){const y=W(n,w);if(!y)return e;const{x:C,y:R}=JSON.parse(e),$=E(y.material.uniforms.uSize1,"value",C,{slider:!0,suffix:"m",prefix:"A",min:1,max:20}),v=E(y.material.uniforms.uSize2,"value",R,{slider:!0,suffix:"m",prefix:"B",min:1,max:20});return x`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${$}${v}</div>
          `}if(h==="Near Frustum"&&N.three instanceof z&&typeof e=="number"){const y=N.three;return E(N.three,"near",e,{slider:!0,min:.1,max:10,step:.1,onInputSet:()=>y.updateProjectionMatrix()})}if(h==="Far Frustum"&&N.three instanceof z&&typeof e=="number"){const y=N.three;return E(N.three,"far",e,{slider:!0,min:300,max:2e3,step:10,onInputSet:()=>y.updateProjectionMatrix()})}if(h==="Field of View"&&N.three instanceof z&&typeof e=="number"){const y=N.three;return E(N.three,"fov",e,{slider:!0,min:10,max:120,onInputSet:()=>y.updateProjectionMatrix()})}if(h==="Invert Drag"&&N.hasCameraControls()&&typeof e=="boolean")return k(N.controls,"dollyDragInverted",e);if(h==="Dolly Speed"&&N.hasCameraControls()&&typeof e=="number")return E(N.controls,"dollySpeed",e,{slider:!0,min:.5,max:3,step:.1});if(h==="Truck Speed"&&N.hasCameraControls()&&typeof e=="number")return E(N.controls,"truckSpeed",e,{slider:!0,min:.5,max:6,step:.1});if(h==="Smooth Time"&&N.hasCameraControls()&&typeof e=="number")return E(N.controls,"smoothTime",e,{slider:!0,min:.01,max:2,step:.01});if(h==="Intensity"&&typeof e=="number"){if(u.Light&&typeof u.Light=="string"){const y=I.three.children.find(C=>C.uuid===u.Light);return y&&y instanceof _?E(y,"intensity",e,{slider:!0,min:0,max:10,step:.1}):e}if(u.IsAOConfig&&p instanceof A)return E(p.postproduction.n8ao.configuration,"intensity",e,{slider:!0,max:16,step:.1})}if(h==="Color"&&typeof e=="string"){const y=u.Light,C=I.three.children.find(R=>R.uuid===y);if(C&&C instanceof _)return at(C,e);if(u.IsAOConfig&&p instanceof A)return ct(p,e)}if(h==="Ambient Oclussion"&&typeof e=="boolean"&&u.IsAOConfig&&p instanceof A)return dt(p,e);if(h==="Half Resolution"&&u.IsAOConfig&&p instanceof A&&typeof e=="boolean")return k(p.postproduction.n8ao.configuration,"halfRes",e);if(h==="Screen Space Radius"&&u.IsAOConfig&&p instanceof A&&typeof e=="boolean")return k(p.postproduction.n8ao.configuration,"screenSpaceRadius",e);if(h==="Radius"&&u.IsAOConfig&&p instanceof A&&typeof e=="number")return E(p.postproduction.n8ao.configuration,"aoRadius",e,{slider:!0,max:2,step:.1});if(h==="Denoise Samples"&&u.IsAOConfig&&p instanceof A&&typeof e=="number")return E(p.postproduction.n8ao.configuration,"denoiseSamples",e,{slider:!0,min:1,max:16});if(h==="Samples"&&u.IsAOConfig&&p instanceof A&&typeof e=="number")return E(p.postproduction.n8ao.configuration,"aoSamples",e,{slider:!0,min:1,max:16});if(h==="Denoise Radius"&&u.IsAOConfig&&p instanceof A&&typeof e=="number")return E(p.postproduction.n8ao.configuration,"denoiseRadius",e,{slider:!0,min:0,max:16,step:.1});if(h==="Distance Falloff"&&u.IsAOConfig&&p instanceof A&&typeof e=="number")return E(p.postproduction.n8ao.configuration,"distanceFalloff",e,{slider:!0,min:0,max:4,step:.1});if(h==="Directional Light"&&u.Light&&typeof u.Light=="string"&&typeof e=="boolean"){const y=I.three.children.find(C=>C.uuid===u.Light);return y&&y instanceof _?k(y,"visible",e):e}if(h==="Ambient Light"&&u.Light&&typeof u.Light=="string"&&typeof e=="boolean"){const y=I.three.children.find(C=>C.uuid===u.Light);return y&&y instanceof _?k(y,"visible",e):e}if(h==="Position"&&u.Light&&typeof u.Light=="string"&&typeof e=="string"){const y=I.three.children.find(P=>P.uuid===u.Light);if(!(y&&y instanceof _))return e;const{x:C,y:R,z:$}=JSON.parse(e),v=E(y.position,"x",C,{slider:!0,prefix:"X",suffix:"m",min:-50,max:50}),D=E(y.position,"y",R,{slider:!0,prefix:"Y",suffix:"m",min:-50,max:50}),T=E(y.position,"z",$,{slider:!0,prefix:"Z",suffix:"m",min:-50,max:50});return x`
            <div style="display: flex; gap: 0.25rem; width: 100%; flex-wrap: wrap">${v}${D}${T}</div>
          `}return h==="Custom Effects"&&u.IsCEConfig&&p instanceof A&&typeof e=="boolean"?mt(p,e):h==="Color"&&u.IsOutlineConfig&&p instanceof A&&typeof e=="string"?lt(p,e):h==="Tolerance"&&u.IsOutlineConfig&&p instanceof A&&typeof e=="number"?E(p.postproduction.customEffects,"tolerance",e,{slider:!0,min:0,max:6,step:.01}):h==="Outline"&&u.IsOutlineConfig&&p instanceof A&&typeof e=="boolean"?k(p.postproduction.customEffects,"outlineEnabled",e):h==="Gloss"&&u.IsGlossConfig&&p instanceof A&&typeof e=="boolean"?k(p.postproduction.customEffects,"glossEnabled",e):h==="Min"&&u.IsGlossConfig&&p instanceof A&&typeof e=="number"?E(p.postproduction.customEffects,"minGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):h==="Max"&&u.IsGlossConfig&&p instanceof A&&typeof e=="number"?E(p.postproduction.customEffects,"maxGloss",e,{slider:!0,min:-.5,max:.5,step:.01}):h==="Exponent"&&u.IsGlossConfig&&p instanceof A&&typeof e=="number"?E(p.postproduction.customEffects,"glossExponent",e,{slider:!0,min:0,max:5,step:.01}):h==="Gamma Correction"&&u.IsGammaConfig&&p instanceof A&&typeof e=="boolean"?ft(p,e):e}};const c=[];for(const[,e]of i.list){const{scene:u,camera:b,renderer:w}=e,I=W(n,e),N={data:{Name:e instanceof Ie&&e.name||e.uuid},children:[]};if(u){const p={data:{Name:"Scene"}};if(I){const R=`#${I.material.uniforms.uColor.value.getHexString()}`,$=JSON.stringify({x:I.material.uniforms.uSize1.value,y:I.material.uniforms.uSize2.value}),v={data:{Name:"Grid",Value:I.three.visible,World:e.uuid,IsGridConfig:!0},children:[{data:{Name:"Color",Value:R,World:e.uuid,IsGridConfig:!0}},{data:{Name:"Size",Value:$,World:e.uuid,IsGridConfig:!0}},{data:{Name:"Distance",Value:I.material.uniforms.uDistance.value,World:e.uuid,IsGridConfig:!0}}]};p.children||(p.children=[]),p.children.push(v)}const h=u.three.children.filter(C=>C instanceof we);for(const C of h){const R={data:{Name:"Directional Light",Value:C.visible,World:e.uuid,Light:C.uuid},children:[{data:{Name:"Position",Value:JSON.stringify(C.position),World:e.uuid,Light:C.uuid}},{data:{Name:"Intensity",Value:C.intensity,World:e.uuid,Light:C.uuid}},{data:{Name:"Color",Value:`#${C.color.getHexString()}`,World:e.uuid,Light:C.uuid}}]};p.children||(p.children=[]),p.children.push(R)}const y=u.three.children.filter(C=>C instanceof Ne);for(const C of y){const R={data:{Name:"Ambient Light",Value:C.visible,World:e.uuid,Light:C.uuid},children:[{data:{Name:"Intensity",Value:C.intensity,World:e.uuid,Light:C.uuid}},{data:{Name:"Color",Value:`#${C.color.getHexString()}`,World:e.uuid,Light:C.uuid}}]};p.children||(p.children=[]),p.children.push(R)}p.children&&((o=p.children)==null?void 0:o.length)>0&&((d=N.children)==null||d.push(p))}if(b.three instanceof z){const p={data:{Name:"Perspective Camera"},children:[{data:{Name:"Near Frustum",Value:b.three.near,World:e.uuid}},{data:{Name:"Far Frustum",Value:b.three.far,World:e.uuid}},{data:{Name:"Field of View",Value:b.three.fov,World:e.uuid}}]};if(b.hasCameraControls()){const{controls:h}=b,y={dollyDragInverted:"Invert Drag",dollySpeed:"Dolly Speed",truckSpeed:"Truck Speed",smoothTime:"Smooth Time"};for(const C in y){const R=h[C];R!=null&&((g=p.children)==null||g.push({data:{Name:y[C],Value:R,World:e.uuid}}))}}(m=N.children)==null||m.push(p)}if(w instanceof A){const{postproduction:p}=w,h=p.n8ao.configuration,y={data:{Name:"Renderer"},children:[{data:{Name:"Gamma Correction",Value:p.settings.gamma??!1,World:e.uuid,IsGammaConfig:!0}},{data:{Name:"Ambient Oclussion",Value:p.settings.ao??!1,World:e.uuid,IsAOConfig:!0},children:[{data:{Name:"Samples",Value:h.aoSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Color",Value:`#${h.color.getHexString()}`,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Half Resolution",Value:h.halfRes,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Screen Space Radius",Value:h.screenSpaceRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Radius",Value:h.aoRadius,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Intensity",Value:h.intensity,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Distance Falloff",Value:h.distanceFalloff,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Samples",Value:h.denoiseSamples,World:e.uuid,IsAOConfig:!0}},{data:{Name:"Denoise Radius",Value:h.denoiseRadius,World:e.uuid,IsAOConfig:!0}}]},{data:{Name:"Custom Effects",Value:p.settings.custom??!1,World:e.uuid,IsCEConfig:!0},children:[{data:{Name:"Gloss",Value:p.customEffects.glossEnabled,World:e.uuid,IsGlossConfig:!0},children:[{data:{Name:"Min",Value:p.customEffects.minGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Max",Value:p.customEffects.maxGloss,World:e.uuid,IsGlossConfig:!0}},{data:{Name:"Exponent",Value:p.customEffects.glossExponent,World:e.uuid,IsGlossConfig:!0}}]},{data:{Name:"Outline",Value:p.customEffects.outlineEnabled,World:e.uuid,IsOutlineConfig:!0},children:[{data:{Name:"Color",get Value(){const C=new H(p.customEffects.lineColor),R=p.customEffects.opacity;return JSON.stringify({color:`#${C.getHexString()}`,opacity:R})},World:e.uuid,IsOutlineConfig:!0}},{data:{Name:"Tolerance",Value:p.customEffects.tolerance,World:e.uuid,IsOutlineConfig:!0}}]}]}]};(f=N.children)==null||f.push(y)}c.push(N)}a.columns=[{name:"Name",width:"11rem"}],a.hiddenColumns=["World","Light","IsAOConfig","IsCEConfig","IsGlossConfig","IsOutlineConfig","IsGammaConfig","IsGridConfig"],a.data=c})} headers-hidden expanded>
     <bim-label slot="missing-data" style="--bim-icon--c: gold" icon="ic:round-warning">
        No worlds to configure
      </bim-label>
    </bim-table>
  `},gt=(t,n=!0)=>{const i=M.create(pt,t);if(n){const[,s]=i,{components:l}=t;l.get(oe).list.onItemDeleted.add(()=>s())}return i},ht=Object.freeze(Object.defineProperty({__proto__:null,worldsConfiguration:gt},Symbol.toStringTag,{value:"Module"})),Ct={...Le,...Ve,...Fe,...tt,...rt,...ht,...Ee,...Oe,...Re};export{Ct as t};
