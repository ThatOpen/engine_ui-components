import"./modulepreload-polyfill-B5Qt9EMX.js";import{E as v,d as x,q as A,$ as S,W as B,F as $,I as P,p as R,t as T,a as D,C as F,M as f,b as W}from"./index-BJN8AjRC.js";import{b as M,E as N,m as d,_ as p}from"./index-RJxXwJnz.js";M.registerComponents();const m=document.getElementById("grid");m.layouts={main:`
  "c-panels-left viewer" 1fr
  "c-panels-table c-panels-table" minmax(auto, 450px)
  /auto 1fr
  `};m.layout="main";const U=document.querySelector("bim-panel[name='entityAttributes']"),q=m.getContainer("panels","left");q.append(U);const y=document.getElementById("viewer-container"),o=new v,H=o.get(x),c=H.create(),g=new A(o);g.setup();c.scene=g;const w=new S(o,y);c.renderer=w;const E=new B(o);c.camera=E;y.addEventListener("resize",()=>{w.resize(),E.updateAspect()});o.init();const j=o.get($);j.create(c);const I=o.get(P);await I.setup();const O=await fetch("/resources/small.ifc"),z=await O.arrayBuffer(),h=new Uint8Array(z),i=await I.load(h);c.scene.three.add(i);const V=o.get(R);await V.process(i);const s={padding:"0.25rem",borderRadius:"0.25rem"},_={Entity:t=>{let e={};return t===f[W]&&(e={...s,backgroundColor:"purple",color:"white"}),String(t).includes("IFCWALL")&&(e={...s,backgroundColor:"green",color:"white"}),d`<bim-label label=${t} style=${p(e)}></bim-label>`},PredefinedType:t=>{const e=["#1c8d83","#3c1c8d","#386c19","#837c24"],n=Math.floor(Math.random()*e.length),l=e[n],a={...s,backgroundColor:l,color:"white"};return d`<bim-label label=${t} style=${p(a)}></bim-label>`},NominalValue:t=>{let e={};return typeof t=="boolean"&&t===!1&&(e={...s,backgroundColor:"#b13535",color:"white"}),typeof t=="boolean"&&t===!0&&(e={...s,backgroundColor:"#18882c",color:"white"}),d`<bim-label label=${t} style=${p(e)}></bim-label>`}},[C,u]=T.entityAttributes({components:o,model:i,expressIDs:[],attributeElements:_}),G=m.getContainer("panels","table");G.append(C);const Q=N.create(()=>{const t=document.createElement("bim-dropdown");t.label="ExpressIDs",t.multiple=!0;const e=i.getLocalProperties();if(e)for(const n in e){const{type:l}=e[n];if(l!==D)continue;const a=document.createElement("bim-option"),k=f[l];a.label=`${n}: ${k}`,a.value=n,t.append(a)}return t.addEventListener("change",()=>{u({expressIDs:t.value})}),d`<div>${t}</div>`}),r=document.getElementById("attributes"),Y=document.querySelector("bim-panel-section[name='tableAttributes']");Y.insertBefore(Q,r);const L=["Name","ContainedInStructure","ForLayerSet","LayerThickness","HasProperties","HasAssociations","HasAssignments","HasPropertySets","PredefinedType","Quantities","ReferencedSource","Identification","Prefix","LongName"];for(const t of L){const e=document.createElement("bim-option");e.label=t,r.append(e)}r.addEventListener("change",()=>{u({attributesToInclude:()=>[...r.value,e=>e.includes("Value"),e=>e.startsWith("Material"),e=>e.startsWith("Relating"),e=>{const n=["IsGroupedBy","IsDecomposedBy"];return e.startsWith("Is")&&!n.includes(e)}]})});r.value=L;const J=document.getElementById("export-json");J.addEventListener("click",()=>{C.downloadData("entities-attributes")});const b=document.getElementById("make-editable");b.addEventListener("change",()=>{u({editable:b.checked})});const K=o.get(F),X=document.getElementById("export-ifc");X.addEventListener("click",async()=>{const t=await K.saveToIfc(i,h),e=new File([t],"small-modified.ifc"),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=e.name,n.click(),URL.revokeObjectURL(n.href)});
