import{F as M,i as O,m as L,c as S,d as I,D as N,e as _,z as T,k as F,B as q}from"./index-DPXt1yPz.js";async function A(t,c){const s=c.get(M),a=new N;for(const[e,d]of s.list)for(const[m,v]of Object.entries(t)){const r=await d.getItemsData(Array.from(v));for(const o of r){if(!o||!("value"in o._category))continue;const l=o._category.value,g=a.get(l)??0;a.set(l,g+1)}}const i=[...a.keys()],n=[...a.values()].map(e=>({value:e}));return{labels:i,datasets:{Categories:n}}}const V=t=>{const{type:c,modelIdMap:s,components:a,addLabels:i=!0}=t,n=a.get(M),e=a.get(O),d=a.get(L),m=t.missingDataMessage??"No data in this chart.";return I`
    <bim-chart ${S(async r=>{if(!r)return;const o=r;if(o.loadFunction=async()=>A(s,a),await o.loadData(!0),i){const l=o.querySelector("[slot='labels']");l&&(l.charts=[o],l.addEventListener("label-click",async g=>{const b=g,{label:h,visibility:f}=b.detail,u=[];for(const[y,p]of n.list){const C=await p.getItemsOfCategories([new RegExp(h)]),D=Object.values(C).flat(),w={[y]:new Set(D)};u.push(d.set(f,w))}u.push(n.core.update(!0)),await Promise.all(u)}))}o.addEventListener("sectionclick",async l=>{const g=l,{label:b}=g.detail;for(const[h,f]of n.list){const u=await f.getItemsOfCategories([new RegExp(b)]),y=Object.values(u).flat(),p={[h]:new Set(y)};e.highlightByID("select",p,!0,!0)}})})} type=${c??"bar"}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">${m}</bim-label>
      ${i?I`<bim-chart-legend slot="labels"></bim-chart-legend>`:""}
    </bim-chart>
  `},G=t=>_.create(V,t),R=Object.freeze(Object.defineProperty({__proto__:null,categoriesChart:G},Symbol.toStringTag,{value:"Module"})),E="Passed",P="Failed";async function x(t){const c=[],s=[],a={};for(const e of t)for(const[d,m]of e.entries()){for(const v of m.values()){const{guid:r,pass:o}=v;r&&(o?c.push(r):s.push(r))}a[d]={Passed:c,Failed:s}}const i={value:c.length,data:{guids:c,guidsMap:a}},n={value:s.length,data:{guids:s,guidsMap:a}};return{labels:[E,P],datasets:{"IDS Compliance":[i,n]}}}const H=t=>{const{type:c,idsResult:s,components:a,addLabels:i=!0}=t,n=a.get(M),e=a.get(O),d=a.get(L);e.styles.set(E,{color:new F("green"),renderedFaces:T.ONE,opacity:1,transparent:!1}),e.styles.set(P,{color:new F("red"),renderedFaces:T.ONE,opacity:1,transparent:!1});const m=t.missingDataMessage??"No data in this chart.";return I`
    <bim-chart ${S(async r=>{if(!r)return;const o=r;if(o.loadFunction=async()=>{const l=Array.isArray(s)?s:[s];return x(l)},o.colors=["green","red"],await o.loadData(!0),i){const l=o.querySelector("[slot='labels']");l&&(l.charts=[o]),l.addEventListener("label-click",async g=>{const{label:b,data:h,visibility:f}=g.detail,u=[];for(const y of h){const{guidsMap:p}=y;for(const[C,D]of Object.entries(p)){const w=n.list.get(C);if(!w)continue;const $=D[b];if(!$||$.length===0)continue;const k=(async()=>{const j=(await w.getLocalIdsByGuids($)).filter(B=>B!==null);if(j.length===0)return;const z={[C]:new Set(j)};await d.set(f,z)})();u.push(k)}}await Promise.all(u)})}o.addEventListener("sectionclick",async l=>{const{values:g,label:b}=l.detail;await e.clear();for(const h of g){const{data:f}=h;if(!f)continue;const{guids:u}=f;for(const[y,p]of n.list){const C=(await p.getLocalIdsByGuids(u)).filter(w=>w!==null),D={[y]:new Set(C)};await e.highlightByID(b,D,!0,!1)}}})})} type=${c??"bar"} colorfulBars=${c==="bar"}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">${m}</bim-label>
      ${i?I`<bim-chart-legend slot="labels"></bim-chart-legend>`:""}
    </bim-chart>
  `},K=t=>_.create(H,t),U=Object.freeze(Object.defineProperty({__proto__:null,idsChart:K},Symbol.toStringTag,{value:"Module"})),J=t=>{const{charts:c}=t,s=t.missingDataMessage??"No charts attached";return I`
    <bim-chart-legend ${S(async i=>{if(!i)return;const n=i;n.charts=c})}>
      <bim-label slot="no-chart" icon="ph:warning-fill" style="--bim-icon--c: gold;">${s}</bim-label>
    </bim-chart-legend>
  `},Q=t=>_.create(J,t),W=Object.freeze(Object.defineProperty({__proto__:null,labels:Q},Symbol.toStringTag,{value:"Module"}));async function X(t,c){const s={};for(const n of t){let e=n[c];e==null?e="Not defined":e instanceof Date?e=e.toLocaleDateString():e=String(e),s[e]||(s[e]=[]),s[e].push(n)}const a=Object.keys(s),i=[];for(const n of a){const e=s[n];i.push({value:e.length,data:{topics:e.map(({guid:d})=>d)}})}return{labels:a,datasets:{Topics:i}}}const Y=t=>{const{components:c,type:s,addLabels:a=!0,grouper:i="stage"}=t,n=t.filterFunction??(()=>!0),d=[...c.get(q).list.values()].filter(n),m=t.missingDataMessage??"No data in this chart.";return I`
    <bim-chart ${S(async r=>{if(!r)return;const o=r;if(o.loadFunction=async()=>X(d,i),await o.loadData(!0),a){const l=o.querySelector("[slot='labels']");l&&(l.charts=[o])}})} type=${s??"bar"}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">${m}</bim-label>
      ${a?I`<bim-chart-legend slot="labels"></bim-chart-legend>`:""}
    </bim-chart>
  `},Z=t=>_.create(Y,t),tt=Object.freeze(Object.defineProperty({__proto__:null,topicsChart:Z},Symbol.toStringTag,{value:"Module"}));async function et(t,c,s,a){const n=a.get(M).list.get(s);if(!n)return{labels:[],datasets:{}};const e=await n.getAttributesUniqueValues([{categories:[c],get:t}]);if(!e)return{labels:[],datasets:{}};const d=[],m=[];for(const[v,r]of Object.entries(e))for(const{value:o,localIds:l}of Object.values(r)){d.push(o);const g=l.length;m.push({value:g,data:{modelIdMap:{[s]:new Set(l)}}})}return{labels:d,datasets:{[t.toString()]:m}}}const at=t=>{const{type:c,attribute:s,category:a,modelId:i,components:n,addLabels:e=!0}=t,d={zoom:!0,...t.highlight},m=n.get(M),v=n.get(O),r=n.get(L),o=t.missingDataMessage??"No data in this chart.";return I`
    <bim-chart ${S(async g=>{if(!g)return;const b=g;if(b.loadFunction=async()=>et(s,a,i,n),await b.loadData(!0),e){const h=b.querySelector("[slot='labels']");h&&(h.charts=[b]),h.addEventListener("label-click",async f=>{const{data:u,visibility:y}=f.detail;for(const p of u){const{modelIdMap:C}=p;await r.set(y,C)}await m.core.update(!0)})}b.addEventListener("sectionclick",async h=>{const{values:f}=h.detail,u=[];for(const y of f){const{data:p}=y;if(!p)continue;const{modelIdMap:C}=p;u.push(v.highlightByID("select",C,!0,d.zoom))}await Promise.all(u)})})} type=${c??"bar"}>
      <bim-label slot="missing-data" icon="ph:warning-fill" style="--bim-icon--c: gold;">${o}</bim-label>
      ${e?I`<bim-chart-legend slot="labels"></bim-chart-legend>`:""}
    </bim-chart>
  `},st=t=>_.create(at,t),nt=Object.freeze(Object.defineProperty({__proto__:null,attributesChart:st},Symbol.toStringTag,{value:"Module"})),ct={...R,...U,...tt,...W,...nt};export{ct as c};
